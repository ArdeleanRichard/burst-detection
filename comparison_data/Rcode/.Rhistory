end<-0
#Computational time
set.seed(126)
source("~/create_sims_functions.R")
source("./create_sims_functions.R")
#No bursts
#Spikes distributed according to a Poisson process, rate 0.5
set.seed(123)
period<-300
rate<-0.5
start<-0
end<-0
pois.no.bursts<-list()
for ( i in 1:50) {
isi.samp<-rexp(n = 200, rate = rate)
isi<-isi.samp[which(cumsum(isi.samp)<period)]
spike.times<-cumsum(isi)
rem.spikes<-which(isi<quantile(isi, 0.1))
st<-NULL
st$spks<-spike.times[-rem.spikes]
pois.no.bursts[[i]]<-st
}
#Spikes with Gamma distributed ISIs
set.seed(126)
period<-300
gamma.no.bursts<-list()
for (i in 1:50) {
gst<-rgamma(200, 1,  rate=0.5)
q<-quantile(gst, 0.1)
gst<-gst[-which(gst<q)]
gsum<-cumsum(gst)
gsum<-gsum[which(gsum<period)]
temp<-NULL
temp$spks<-gsum
gamma.no.bursts[[i]]<-temp
}
all.no.bursts<-append(pois.no.bursts, gamma.no.bursts)
#Non stationary
s<-0
u<-runif(1,0,1)
s<-s-log(u)
t<-sqrt(600*s)+10^(-16)
Lambda<-function(v){
v-1/600*v^2
}
inhom.pois<-list()
set.seed(154)
for (i in 61:100){
s=0
v=seq(0,300,0.002)
X=0
while(X[length(X)]<=300){
u=runif(1,0,1)
s=s-log(u)
t=min(v[which(Vectorize(Lambda)(v)>=s)])
X=c(X,t)
}
X2<-X[-which(X==0)]
X2<-X2[-which(X2>300)]
isi<-diff(X2)
q<-quantile(isi, 0.1)
st<-NULL
st$spks<-X2[-which(isi<q)]
inhom.pois[[i]]<-st
}
View(pois.burst.high)
View(pois.burst.long)
View(pois.burst.long)
View(pois.burst.long)
View(pois.burst.long)
View(all.no.bursts)
View(all.no.bursts)
View(gamma.no.bursts)
set.seed(128)
rate<-0.2
period<-300
mean.length<-5
reg.bursts<-list()
for (i in 1:100){
reg.bursts[[i]]<-pois.burst.noiseless(0.2, 300, 0)
}
View(reg.bursts)
View(pois.burst.noisy)
View(gamma.no.bursts)
View(inhom.pois)
View(pois.no.bursts)
View(reg.bursts)
View(reg.bursts)
